---
import { type CollectionEntry, getCollection, render } from "astro:content";
import FormattedDate from "../../components/FormattedDate.astro";
import { calculateReadingTime, filterDrafts } from "../../utils/data-utils";
import "../../styles/global.css";

type Props = { post: CollectionEntry<"blog"> };

export async function getStaticPaths() {
    const posts = filterDrafts(await getCollection("blog"));
    return posts.map((post) => ({
        params: { id: post.id },
        props: {
            post
        }
    }));
}

const { post } = Astro.props;
const { title, subTitle, publishDate } = post.data;

// Calculate reading time from the post content
const readingTime = calculateReadingTime(post.body);
---

<html>
    <head>
        <meta name="robots" content="noindex, nofollow" />
        <style>
            #og-card {
                width: 1200px;
                height: 630px;
            }
        </style>
    </head>
    <body class="bg-main">
        <header id="og-card" class="bg-main flex flex-col justify-center p-16 align-middle">
            <h1 class="font-serif text-8xl font-bold leading-tight">
                {title}
            </h1>
            {subTitle && <p class="font-serif text-5xl text-gray-600 dark:text-gray-300">{subTitle}</p>}
            <div class="flex flex-col">
                <div class="mt-4 flex flex-wrap items-center gap-4 text-xl">
                    <div class="flex items-center gap-1">
                        <span class="mr-1 font-medium">Published on</span>
                        <FormattedDate date={publishDate} />
                    </div>
                    <div class="flex items-center gap-1">
                        <span>{readingTime}</span>
                    </div>
                </div>
            </div>
        </header>
    </body>
</html>
